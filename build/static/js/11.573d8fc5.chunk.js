(this.webpackJsonpmyapp=this.webpackJsonpmyapp||[]).push([[11],{426:function(e,t,a){"use strict";var n=a(56),l=a(57),r=a(59),o=a(58),i=a(0),c=a.n(i),s=a(77),d=a.n(s),u=a(152),m=a(78),p=a(441),b=a(47),f=a.n(b),h=function(e){Object(r.a)(a,e);var t=Object(o.a)(a);function a(e){var l;return Object(n.a)(this,a),(l=t.call(this,e)).handleDownFile=function(e,t,a){e.preventDefault(),e.stopPropagation(),l.setState({loadingStatus:!1,buttonDisabled:!0});var n=f.a.create({baseURL:"http://10.186.0.210:8001/",responseType:"blob",timeout:1e4,headers:{"Content-Type":"multipart/form-data"}}),r=t;n.get(r).then((function(e){console.log(e);var t="";e.headers&&(t=e.headers["content-disposition"].split("filename=")[1].replace(/"/g,""),console.log(t)),t.length>0&&(a=t),l.loadTxtFile(a,e.data,r),l.setState({loadingStatus:!0,buttonDisabled:!1})})).catch((function(e){l.setState({loadingStatus:!1,buttonDisabled:!1}),console.log("\u6587\u4ef6\u4e0b\u8f7d\u5931\u8d25",e)}))},l.state={loadingStatus:!0,buttonDisabled:!1},l}return Object(l.a)(a,[{key:"loadTxtFile",value:function(e,t,a){console.log(t);var n=document.createElement("a"),l=new Blob([t],{type:"application/octet-stream"});n.download=e,n.href=URL.createObjectURL(l),document.body.appendChild(n);var r=document.createEvent("MouseEvents");r.initEvent("click",!1,!1),n.dispatchEvent(r),document.body.removeChild(n),URL.revokeObjectURL(l)}},{key:"render",value:function(){var e=this,t=this.props,a=t.api_url,n=t.text,l=t.style,r=t.className,o=t.btnType,i=t.fileName,s=t.btnDisabled,d=this.state,b=d.loadingStatus,f=d.buttonDisabled;return"iconBtn"===o?c.a.createElement(u.a,{placement:"bottomLeft",title:n},c.a.createElement(m.a,{type:"primary",style:l,className:r,onClick:function(t){return e.handleDownFile(t,a,i)},disabled:f||s,loading:!b,size:"small",icon:c.a.createElement(p.a,null)})):c.a.createElement(m.a,{type:"primary",style:l,className:r,onClick:function(t){return e.handleDownFile(t,a,i)},disabled:f||s,loading:!b},b?n:"\u4e0b\u8f7d\u4e2d...")}}]),a}(i.PureComponent);h.proTypes={api_url:d.a.isRequired},h.defaultProps={text:"\u6587\u4ef6\u4e0b\u8f7d",icon:"download",className:{},btnDisabled:!1},t.a=h},443:function(e,t,a){"use strict";var n=a(0),l={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M885.2 446.3l-.2-.8-112.2-285.1c-5-16.1-19.9-27.2-36.8-27.2H281.2c-17 0-32.1 11.3-36.9 27.6L139.4 443l-.3.7-.2.8c-1.3 4.9-1.7 9.9-1 14.8-.1 1.6-.2 3.2-.2 4.8V830a60.9 60.9 0 0060.8 60.8h627.2c33.5 0 60.8-27.3 60.9-60.8V464.1c0-1.3 0-2.6-.1-3.7.4-4.9 0-9.6-1.3-14.1zm-295.8-43l-.3 15.7c-.8 44.9-31.8 75.1-77.1 75.1-22.1 0-41.1-7.1-54.8-20.6S436 441.2 435.6 419l-.3-15.7H229.5L309 210h399.2l81.7 193.3H589.4zm-375 76.8h157.3c24.3 57.1 76 90.8 140.4 90.8 33.7 0 65-9.4 90.3-27.2 22.2-15.6 39.5-37.4 50.7-63.6h156.5V814H214.4V480.1z"}}]},name:"inbox",theme:"outlined"},r=a(149),o=function(e,t){return n.createElement(r.a,Object.assign({},e,{ref:t,icon:l}))};o.displayName="InboxOutlined";t.a=n.forwardRef(o)},506:function(e,t,a){"use strict";a.r(t);var n=a(56),l=a(57),r=a(59),o=a(58),i=a(0),c=a.n(i),s=a(60),d=a(427),u=a.n(d),m=a(47),p=a.n(m),b=a(493),f=a(494),h=a(440),v=a(496),g=a(421),y=a(422),E=a(219),D=a(78),k=a(490),x=a(500),w=a(152),C=a(156),I=a(150),O=a(34),_=a(35);function T(){var e=Object(O.a)(["\n    text-align: right;\n    padding: 20px;\n"]);return T=function(){return e},e}function j(){var e=Object(O.a)(["\n    background:#fff;\n    padding: 0 20px;\n    min-height: calc(100vh - 156px);\n    & .edit-btn{\n        background: #faad14;\n        color: #fff;\n        border-color: #faad14;\n    }\n    & .edit-btn:focus,.edit-btn:hover{\n        background:#fbc457;\n        border-color: #fbc457;\n    }\n    & .start-btn{\n        background: #52c41a;\n        border-color: #52c41a;\n        color: #fff;\n    }\n    & .start-btn:focus,.start-btn:hover{\n        background: #74d445;\n        border-color: #74d445;\n    }\n    & .stop-btn{\n        background: #181918;\n        border-color: #181918;\n        color: #fff;\n    }\n    & .stop-btn:focus,.stop-btn:hover{\n        background: #656765;\n        border-color: #656765;\n    }\n\n"]);return j=function(){return e},e}function S(){var e=Object(O.a)(["\n    margin:30px 10px 0;\n"]);return S=function(){return e},e}var M=_.b.main(S()),N=_.b.div(j()),L=_.b.div(T()),F=a(443),z=a(509),R=a(426),U=b.a.Column,H=f.a.Dragger,B=h.a.Option,V={labelCol:{span:6},wrapperCol:{span:16}},q={wrapperCol:{offset:6,span:16}},Y=function(e){Object(r.a)(a,e);var t=Object(o.a)(a);function a(){var e;Object(n.a)(this,a);for(var l=arguments.length,r=new Array(l),o=0;o<l;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={visible:!1,type:"add",data:{}},e.showModal=function(t,a){e.setState({visible:!0,type:t,data:a})},e.handleFinish=function(t){console.log(t);var a=new FormData;a.append("file",t.file.file),a.append("user_filename",t.user_filename),a.append("msg_type","upload"),a.append("env_name",t.env_name),a.append("desc",t.desc);var n=p.a.create({baseURL:"http://10.186.0.210:8001/",timeout:1e3,headers:{"Content-Type":"multipart/form-data"}}),l="api/v1/auto-lm/trainset/";console.log(l),n.post(l,a).then((function(t){console.log(t),e.reload()})),e.setState({visible:!1})},e.handleCancel=function(t){console.log(t),e.setState({visible:!1})},e.reload=function(){e.componentDidMount()},e}return Object(l.a)(a,[{key:"renderModal",value:function(){var e="\u6dfb\u52a0";return"edit"===this.state.type&&(e="\u7f16\u8f91"),console.log(this.state.type,this.state.data),c.a.createElement(v.a,{title:e+"\u8bad\u7ec3\u96c6",visible:this.state.visible,onCancel:this.handleCancel,footer:null,destroyOnClose:!0},c.a.createElement(g.a,Object.assign({},V,{name:"basic",initialValues:this.state.data,onFinish:this.handleFinish}),c.a.createElement(g.a.Item,{label:"\u8bad\u7ec3\u96c6\u540d\u79f0",name:"user_filename",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u8bad\u7ec3\u96c6\u540d\u79f0!"}]},c.a.createElement(y.a,null)),c.a.createElement(g.a.Item,{label:"\u6240\u5c5e\u8bad\u7ec3\u73af\u5883",name:"env_name",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u8bad\u7ec3\u73af\u5883!"}]},c.a.createElement(h.a,{disabled:"edit"===this.state.type},this.props.envs.map((function(e){return c.a.createElement(B,{value:e.name,key:e.name},e.display_name)})))),c.a.createElement(g.a.Item,{label:"\u8bad\u7ec3\u96c6\u63cf\u8ff0",name:"desc"},c.a.createElement(y.a,null)),c.a.createElement(g.a.Item,{label:"\u4e0a\u4f20\u8bad\u7ec3\u96c6",name:"file",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u8bad\u7ec3\u96c6!"}]},c.a.createElement(H,{name:"file",accept:".txt",beforeUpload:function(e){return e.size/1024/1024<=10||E.a.error("\u6587\u4ef6\u5927\u5c0f\u9650\u5236\u572810M\u4ee5\u4e0b\uff01"),!1}},c.a.createElement("p",{className:"ant-upload-drag-icon"},c.a.createElement(F.a,null)),c.a.createElement("p",{className:"ant-upload-text"},"\u70b9\u51fb\u6216\u62d6\u62fd\u5230\u8fd9\u4e2a\u533a\u57df\u8fdb\u884c\u4e0a\u4f20"),c.a.createElement("p",{className:"ant-upload-hint"},"\u652f\u6301txt\u683c\u5f0f\uff0c\u4e14\u6587\u4ef6\u5927\u5c0f\u4e0d\u80fd\u8d85\u8fc710MB"))),c.a.createElement(g.a.Item,q,c.a.createElement(D.a,{type:"primary",htmlType:"submit"},"\u786e\u5b9a"))))}},{key:"render",value:function(){var e=this;function t(e){console.log(e)}var a=this.props,n=a.tableData,l=a.handleDeleteTableItem;return c.a.createElement(M,null,c.a.createElement(N,null,c.a.createElement(L,null,c.a.createElement(D.a,{type:"primary",onClick:function(){return e.showModal("add",{env_name:e.props.envs[0].name,desc:"",user_filename:"",file:{}})}},"\u6dfb\u52a0\u8bad\u7ec3\u96c6")),this.renderModal(),c.a.createElement(b.a,{dataSource:n,rowKey:function(e,t){return e.file_id}},c.a.createElement(U,{title:"\u73af\u5883\u540d\u79f0",width:"10",align:"center",dataIndex:"env_name",key:"envName"}),c.a.createElement(U,{title:"\u8bad\u7ec3\u96c6\u540d\u79f0",width:"10",align:"center",dataIndex:"user_filename",key:"trainSetName"}),c.a.createElement(U,{title:"\u8bad\u7ec3\u96c6\u63cf\u8ff0",align:"center",dataIndex:"desc",key:"trainSetDesc"}),c.a.createElement(U,{title:"\u521b\u5efa\u65f6\u95f4",align:"center",dataIndex:"created_at",key:"createTime",render:function(e){return c.a.createElement("span",null,u()(e).format("YYYY-MM-DD HH:mm:ss"))}}),c.a.createElement(U,{title:"\u64cd\u4f5c",key:"action",align:"center",render:function(e,a,n){return c.a.createElement(k.a,{size:"small"},c.a.createElement(R.a,{api_url:"api/v1/auto-lm/download/?type=train&id="+a.file_id,btnType:"iconBtn",fileName:a.user_filename}),c.a.createElement(x.a,{title:"\u786e\u8ba4\u5220\u9664\uff1f",onConfirm:function(){return l(a,n)},onCancel:t,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88"},c.a.createElement(w.a,{placement:"bottomLeft",title:"\u5220\u9664"},c.a.createElement(D.a,{type:"danger",size:"small",icon:c.a.createElement(z.a,null)}))))}}))))}},{key:"componentDidMount",value:function(){console.log("xxx"),this.props.handleInitTableData(),0===this.props.envs.size&&this.props.handleInitEnvData()}}]),a}(i.Component);t.default=Object(s.b)((function(e){return{tableData:e.getIn(["trainSet","tableData"]),envs:e.getIn(["trainModel","envs"])}}),(function(e){return{handleInitEnvData:function(){e(I.a.handleChangeEnv())},handleInitTableData:function(){e(C.a.handleInitTableData())},handleDeleteTableItem:function(t,a){e(C.a.handleDeleteTableItem(a,t))}}}))(Y)}}]);
//# sourceMappingURL=11.573d8fc5.chunk.js.map