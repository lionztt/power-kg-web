(this.webpackJsonpmyapp=this.webpackJsonpmyapp||[]).push([[10],{426:function(e,t,a){"use strict";var n=a(56),l=a(57),i=a(59),r=a(58),o=a(0),s=a.n(o),c=a(77),d=a.n(c),m=a(152),u=a(78),p=a(441),f=a(47),h=a.n(f),b=function(e){Object(i.a)(a,e);var t=Object(r.a)(a);function a(e){var l;return Object(n.a)(this,a),(l=t.call(this,e)).handleDownFile=function(e,t,a){e.preventDefault(),e.stopPropagation(),l.setState({loadingStatus:!1,buttonDisabled:!0});var n=h.a.create({baseURL:"http://10.186.0.210:8001/",responseType:"blob",timeout:1e4,headers:{"Content-Type":"multipart/form-data"}}),i=t;n.get(i).then((function(e){console.log(e);var t="";e.headers&&(t=e.headers["content-disposition"].split("filename=")[1].replace(/"/g,""),console.log(t)),t.length>0&&(a=t),l.loadTxtFile(a,e.data,i),l.setState({loadingStatus:!0,buttonDisabled:!1})})).catch((function(e){l.setState({loadingStatus:!1,buttonDisabled:!1}),console.log("\u6587\u4ef6\u4e0b\u8f7d\u5931\u8d25",e)}))},l.state={loadingStatus:!0,buttonDisabled:!1},l}return Object(l.a)(a,[{key:"loadTxtFile",value:function(e,t,a){console.log(t);var n=document.createElement("a"),l=new Blob([t],{type:"application/octet-stream"});n.download=e,n.href=URL.createObjectURL(l),document.body.appendChild(n);var i=document.createEvent("MouseEvents");i.initEvent("click",!1,!1),n.dispatchEvent(i),document.body.removeChild(n),URL.revokeObjectURL(l)}},{key:"render",value:function(){var e=this,t=this.props,a=t.api_url,n=t.text,l=t.style,i=t.className,r=t.btnType,o=t.fileName,c=t.btnDisabled,d=this.state,f=d.loadingStatus,h=d.buttonDisabled;return"iconBtn"===r?s.a.createElement(m.a,{placement:"bottomLeft",title:n},s.a.createElement(u.a,{type:"primary",style:l,className:i,onClick:function(t){return e.handleDownFile(t,a,o)},disabled:h||c,loading:!f,size:"small",icon:s.a.createElement(p.a,null)})):s.a.createElement(u.a,{type:"primary",style:l,className:i,onClick:function(t){return e.handleDownFile(t,a,o)},disabled:h||c,loading:!f},f?n:"\u4e0b\u8f7d\u4e2d...")}}]),a}(o.PureComponent);b.proTypes={api_url:d.a.isRequired},b.defaultProps={text:"\u6587\u4ef6\u4e0b\u8f7d",icon:"download",className:{},btnDisabled:!1},t.a=b},441:function(e,t,a){"use strict";var n=a(0),l={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M505.7 661a8 8 0 0012.6 0l112-141.7c4.1-5.2.4-12.9-6.3-12.9h-74.1V168c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v338.3H400c-6.7 0-10.4 7.7-6.3 12.9l112 141.8zM878 626h-60c-4.4 0-8 3.6-8 8v154H214V634c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v198c0 17.7 14.3 32 32 32h684c17.7 0 32-14.3 32-32V634c0-4.4-3.6-8-8-8z"}}]},name:"download",theme:"outlined"},i=a(149),r=function(e,t){return n.createElement(i.a,Object.assign({},e,{ref:t,icon:l}))};r.displayName="DownloadOutlined";t.a=n.forwardRef(r)},497:function(e,t,a){"use strict";a.r(t);var n=a(56),l=a(57),i=a(59),r=a(58),o=a(0),s=a.n(o),c=a(60),d=a(427),m=a.n(d),u=a(493),p=a(440),f=a(496),h=a(421),b=a(422),g=a(419),v=a(78),_=a(490),y=a(152),E=a(500),k=a(150),w=a(157),D=a(156),I=a(158),S=a(34),x=a(35);function C(){var e=Object(S.a)(["\n    text-align: right;\n    padding: 20px;\n"]);return C=function(){return e},e}function M(){var e=Object(S.a)(["\n    background:#fff;\n    padding: 0 20px;\n    min-height: calc(100vh - 156px);\n    & .edit-btn{\n        background: #faad14;\n        color: #fff;\n        border-color: #faad14;\n    }\n    & .edit-btn:focus,.edit-btn:hover{\n        background:#fbc457;\n        border-color: #fbc457;\n    }\n    & .start-btn{\n        background: #52c41a;\n        border-color: #52c41a;\n        color: #fff;\n    }\n    & .start-btn:focus,.start-btn:hover{\n        background: #74d445;\n        border-color: #74d445;\n    }\n    & .stop-btn{\n        background: #181918;\n        border-color: #181918;\n        color: #fff;\n    }\n    & .stop-btn:focus,.stop-btn:hover{\n        background: #656765;\n        border-color: #656765;\n    }\n\n"]);return M=function(){return e},e}function T(){var e=Object(S.a)(["\n    margin:30px 10px 0;\n"]);return T=function(){return e},e}var O=x.b.main(T()),z=x.b.div(M()),j=x.b.div(C()),L=a(426),N={icon:function(e,t){return{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z",fill:e}},{tag:"path",attrs:{d:"M512 140c-205.4 0-372 166.6-372 372s166.6 372 372 372 372-166.6 372-372-166.6-372-372-372zm193.4 225.7l-210.6 292a31.8 31.8 0 01-51.7 0L318.5 484.9c-3.8-5.3 0-12.7 6.5-12.7h46.9c10.3 0 19.9 5 25.9 13.3l71.2 98.8 157.2-218c6-8.4 15.7-13.3 25.9-13.3H699c6.5 0 10.3 7.4 6.4 12.7z",fill:t}},{tag:"path",attrs:{d:"M699 353h-46.9c-10.2 0-19.9 4.9-25.9 13.3L469 584.3l-71.2-98.8c-6-8.3-15.6-13.3-25.9-13.3H325c-6.5 0-10.3 7.4-6.5 12.7l124.6 172.8a31.8 31.8 0 0051.7 0l210.6-292c3.9-5.3.1-12.7-6.4-12.7z",fill:e}}]}},name:"check-circle",theme:"twotone"},F=a(149),R=function(e,t){return o.createElement(F.a,Object.assign({},e,{ref:t,icon:N}))};R.displayName="CheckCircleTwoTone";var B=o.forwardRef(R),H={icon:function(e,t){return{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z",fill:e}},{tag:"path",attrs:{d:"M512 140c-205.4 0-372 166.6-372 372s166.6 372 372 372 372-166.6 372-372-166.6-372-372-372zm171.8 527.1c1.2 1.5 1.9 3.3 1.9 5.2 0 4.5-3.6 8-8 8l-66-.3-99.3-118.4-99.3 118.5-66.1.3c-4.4 0-8-3.6-8-8 0-1.9.7-3.7 1.9-5.2L471 512.3l-130.1-155a8.32 8.32 0 01-1.9-5.2c0-4.5 3.6-8 8-8l66.1.3 99.3 118.4 99.4-118.5 66-.3c4.4 0 8 3.6 8 8 0 1.9-.6 3.8-1.8 5.2l-130.1 155 129.9 154.9z",fill:t}},{tag:"path",attrs:{d:"M685.8 352c0-4.4-3.6-8-8-8l-66 .3-99.4 118.5-99.3-118.4-66.1-.3c-4.4 0-8 3.5-8 8 0 1.9.7 3.7 1.9 5.2l130.1 155-130.1 154.9a8.32 8.32 0 00-1.9 5.2c0 4.4 3.6 8 8 8l66.1-.3 99.3-118.5L611.7 680l66 .3c4.4 0 8-3.5 8-8 0-1.9-.7-3.7-1.9-5.2L553.9 512.2l130.1-155c1.2-1.4 1.8-3.3 1.8-5.2z",fill:e}}]}},name:"close-circle",theme:"twotone"},P=function(e,t){return o.createElement(F.a,Object.assign({},e,{ref:t,icon:H}))};P.displayName="CloseCircleTwoTone";var U=o.forwardRef(P),J={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M257.7 752c2 0 4-.2 6-.5L431.9 722c2-.4 3.9-1.3 5.3-2.8l423.9-423.9a9.96 9.96 0 000-14.1L694.9 114.9c-1.9-1.9-4.4-2.9-7.1-2.9s-5.2 1-7.1 2.9L256.8 538.8c-1.5 1.5-2.4 3.3-2.8 5.3l-29.5 168.2a33.5 33.5 0 009.4 29.8c6.6 6.4 14.9 9.9 23.8 9.9zm67.4-174.4L687.8 215l73.3 73.3-362.7 362.6-88.9 15.7 15.6-89zM880 836H144c-17.7 0-32 14.3-32 32v36c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-36c0-17.7-14.3-32-32-32z"}}]},name:"edit",theme:"outlined"},V=function(e,t){return o.createElement(F.a,Object.assign({},e,{ref:t,icon:J}))};V.displayName="EditOutlined";var Y=o.forwardRef(V),A=a(509),q=a(15),K=u.a.Column,W=p.a.Option;m.a.locale("zh-cn");var G={labelCol:{span:6},wrapperCol:{span:16}},Q={wrapperCol:{offset:6,span:16}},X=function(e){Object(i.a)(a,e);var t=Object(r.a)(a);function a(){var e;Object(n.a)(this,a);for(var l=arguments.length,i=new Array(l),r=0;r<l;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i))).state={visible:!1,type:"add",data:{},formLoading:!1},e.showModal=function(t,a){var n=JSON.parse(JSON.stringify(a));console.log(n),n.am_model=n.am_model.file_id,n.train_set=n.train_set.map((function(e){return e.file_id})),n.test_set=n.test_set.file_id,e.setState({visible:!0,type:t,data:n})},e.handleFinish=function(t){console.log(t),e.setState({formLoading:!0});var a=e.state.type;t.am_model?t.am_model={file_id:t.am_model}:delete t.am_model,t.train_set?t.train_set=t.train_set.map((function(e){return{file_id:e}})):delete t.train_set,t.test_set?t.test_set={file_id:t.test_set}:delete t.test_set,t.params_opt?t.params_opt=1:t.params_opt=0,t.task_name||delete t.task_name,"add"===a?t.task_type="start_train":"edit"===a&&(t.task_id=e.state.data.task_id,t.task_type="start_test");Object(q.c)({url:"api/v1/auto-lm/lm-task/",params:t}).then((function(t){console.log(t),e.setState({formLoading:!1}),e.reload()})).catch((function(t){e.setState({formLoading:!1})})),console.log(t),e.setState({visible:!1})},e.handleCancel=function(t){console.log(t),e.setState({visible:!1})},e.reload=function(){e.componentDidMount()},e}return Object(l.a)(a,[{key:"renderModal",value:function(){var e="\u6dfb\u52a0\u4efb\u52a1";return"edit"===this.state.type&&(e="\u7f16\u8f91\u4efb\u52a1"),console.log(this.state.type,this.state.data,this.props),s.a.createElement(f.a,{title:e+"\u4efb\u52a1",visible:this.state.visible,onCancel:this.handleCancel,footer:null,destroyOnClose:!0},s.a.createElement(h.a,Object.assign({},G,{name:"basic",initialValues:this.state.data,onFinish:this.handleFinish}),s.a.createElement(h.a.Item,{label:"\u4efb\u52a1\u540d\u79f0",name:"task_name"},s.a.createElement(b.a,{disabled:"edit"===this.state.type})),s.a.createElement(h.a.Item,{label:"\u8bad\u7ec3\u73af\u5883",name:"env_name",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u8bad\u7ec3\u73af\u5883!"}]},s.a.createElement(p.a,{disabled:"edit"===this.state.type},this.props.envs.map((function(e){return s.a.createElement(W,{value:e.name,key:e.name},e.display_name)})))),s.a.createElement(h.a.Item,{label:"\u58f0\u5b66\u6a21\u578b",name:"am_model"},s.a.createElement(p.a,{disabled:"edit"===this.state.type},this.props.acousticModels.map((function(e){return s.a.createElement(W,{value:e.file_id,key:e.file_id},e.user_filename)})))),s.a.createElement(h.a.Item,{label:"\u8bad\u7ec3\u96c6",name:"train_set"},s.a.createElement(p.a,{mode:"multiple",disabled:"edit"===this.state.type},this.props.trainSets.map((function(e){return s.a.createElement(W,{value:e.file_id,key:e.file_id},e.user_filename)})))),s.a.createElement(h.a.Item,{label:"\u6d4b\u8bd5\u96c6",name:"test_set"},s.a.createElement(p.a,null,this.props.testSets.map((function(e){return s.a.createElement(W,{value:e.file_id,key:e.file_id},e.user_filename)})))),s.a.createElement(h.a.Item,Object.assign({},Q,{disabled:"edit"===this.state.type,name:"params_opt",valuePropName:"checked"}),s.a.createElement(g.a,null,"\u4f18\u5316\u89e3\u7801\u53c2\u6570")),s.a.createElement(h.a.Item,Q,s.a.createElement(v.a,{loading:this.state.formLoading,type:"primary",htmlType:"submit"},"\u5f00\u59cb\u89e3\u7801"))))}},{key:"render",value:function(){var e=this;function t(e){console.log(e)}var a=this.props,n=a.tableData,l=a.handleDeleteTableItem;return console.log(n),s.a.createElement(O,null,s.a.createElement(z,null,s.a.createElement(j,null,s.a.createElement(v.a,{type:"primary",style:{marginRight:"10px"},onClick:this.reload},"\u5237\u65b0\u9875\u9762"),s.a.createElement(v.a,{type:"primary",onClick:function(){return e.showModal("add",{task_name:"",env_name:e.props.envs[0].name,am_model:e.props.acousticModels[0],train_set:[],test_set:"",params_opt:!1})}},"\u6dfb\u52a0\u4efb\u52a1")),this.renderModal(),s.a.createElement(u.a,{dataSource:n,rowKey:function(e,t){return e.task_id}},s.a.createElement(K,{title:"\u4efb\u52a1\u540d\u79f0",width:"8%",align:"center",dataIndex:"task_name",key:"projectName"}),s.a.createElement(K,{title:"\u8bad\u7ec3\u73af\u5883",width:"8%",align:"center",dataIndex:"env_name",key:"environment"}),s.a.createElement(K,{title:"\u58f0\u5b66\u6a21\u578b",width:"10%",align:"center",dataIndex:["am_model","user_filename"],key:"audioModel"}),s.a.createElement(K,{title:"\u8bad\u7ec3\u96c6",width:"16%",align:"center",dataIndex:"train_set",key:"trainSet",render:function(e,t){return s.a.createElement(s.a.Fragment,null,e?e.map((function(e){return s.a.createElement("span",{key:e.file_id},e.user_filename,s.a.createElement("br",null))})):null)}}),s.a.createElement(K,{title:"\u6d4b\u8bd5\u96c6",width:"10%",align:"center",dataIndex:["test_set","user_filename"],key:"testSet"}),s.a.createElement(K,{title:"\u89e3\u7801\u4f18\u5316",width:"8%",align:"center",dataIndex:"params_opt",key:"isOptimised",render:function(e,t){return 1===e?s.a.createElement(B,{style:{fontSize:"20px"},twoToneColor:"#52c41a"}):s.a.createElement(U,{style:{fontSize:"20px"},twoToneColor:"#ff4d4f"})}}),s.a.createElement(K,{title:"\u5b57\u51c6",width:"7%",align:"center",dataIndex:"test_set_wer",key:"testWordPercentage",render:function(e,t){return 0===e?e:e+"%"}}),s.a.createElement(K,{title:"\u53e5\u51c6",width:"7%",align:"center",dataIndex:"test_set_ser",key:"testSenPercentage",render:function(e,t){return 0===e?e:e+"%"}}),s.a.createElement(K,{title:"\u89e3\u7801",width:"8%",align:"center",dataIndex:"testDecodeFile",key:"testDecodeFile",render:function(e,t){return s.a.createElement(_.a,{size:"small"},s.a.createElement(L.a,{api_url:"api/v1/auto-lm/download/?type=decode&id="+t.task_id,btnType:"iconBtn",btnDisabled:"SUCCESS"!==t.task_status,fileName:t.task_name?t.task_name+"decode.txt":"decode.txt"}))}}),s.a.createElement(K,{title:"\u66f4\u65b0\u65f6\u95f4",width:"10%",align:"center",dataIndex:"updated_at",key:"createTime",render:function(e){return s.a.createElement("span",null,m()(e).format("YYYY-MM-DD HH:mm:ss"))}}),s.a.createElement(K,{title:"\u64cd\u4f5c",key:"action",align:"center",width:"12%",render:function(a,n,i){return s.a.createElement(_.a,{size:"small"},s.a.createElement(y.a,{placement:"bottomLeft",title:"\u4fee\u6539"},s.a.createElement(v.a,{onClick:function(){return e.showModal("edit",n)},className:"edit-btn",size:"small",icon:s.a.createElement(Y,null)})),s.a.createElement(E.a,{title:"\u786e\u8ba4\u5220\u9664\uff1f",onConfirm:function(){return l(i,n)},onCancel:t,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88"},s.a.createElement(y.a,{placement:"bottomLeft",title:"\u5220\u9664"},s.a.createElement(v.a,{type:"danger",size:"small",icon:s.a.createElement(A.a,null)}))))}}))))}},{key:"componentDidMount",value:function(){this.props.handleInitTableData(),this.props.handleInitEnvData(),console.log(this.props.acousticModels),0===this.props.acousticModels.size&&this.props.handleInitAcousticModelsData(),0===this.props.trainSets.size&&this.props.handleInitTrainSetsData(),0===this.props.testSets.size&&this.props.handleInitTestSetsData()}}]),a}(o.Component);t.default=Object(c.b)((function(e){return{tableData:e.getIn(["trainModel","tableData"]),envs:e.getIn(["trainModel","envs"]),acousticModels:e.getIn(["audioModel","tableData"]),trainSets:e.getIn(["trainSet","tableData"]),testSets:e.getIn(["testSet","tableData"])}}),(function(e){return{handleInitEnvData:function(){e(k.a.handleChangeEnv())},handleInitAcousticModelsData:function(){e(w.a.handleInitTableData())},handleInitTrainSetsData:function(){e(D.a.handleInitTableData())},handleInitTestSetsData:function(){e(I.a.handleInitTableData())},handleInitTableData:function(){e(k.a.handleInitTableData())},handleDeleteTableItem:function(t,a){e(k.a.handleDeleteTableItem(t,a))}}}))(X)}}]);
//# sourceMappingURL=10.a386f4d3.chunk.js.map